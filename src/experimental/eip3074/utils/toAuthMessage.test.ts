import { expect, test } from 'vitest'
import { keccak256 } from '../../../utils/index.js'
import { toAuthMessage } from './toAuthMessage.js'

test('default', () => {
  expect(
    toAuthMessage({
      chainId: 1,
      commit: keccak256('0x1234'),
      invokerAddress: '0x0000000000000000000000000000000000000000',
      nonce: 69,
    }),
  ).toMatchInlineSnapshot(
    `"0x0400000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000045000000000000000000000000000000000000000000000000000000000000000056570de287d73cd1cb6092bb8fdee6173974955fdef345ae579ee9f475ea7432"`,
  )

  expect(
    toAuthMessage({
      chainId: 1,
      commit: keccak256('0x1234'),
      invokerAddress: '0xe044814c9ed1e6442af956a817c161192cbae98f',
      nonce: 378,
    }),
  ).toMatchInlineSnapshot(
    `"0x040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000017a000000000000000000000000e044814c9ed1e6442af956a817c161192cbae98f56570de287d73cd1cb6092bb8fdee6173974955fdef345ae579ee9f475ea7432"`,
  )
})
