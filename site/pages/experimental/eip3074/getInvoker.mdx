---
description: Interface for interacting with EIP-3074 "invoker" contracts. 
---

# Invoker Instances

An Invoker Instance is an interface for interacting with contracts that implement the [3074-invokers `BaseInvoker`](https://github.com/anton-rs/3074-invokers/blob/05cc5b8532c0b52c9741658f59d1106fd8ced6f2/src/BaseInvoker.sol) interface.  

## Preface

The purpose of an [EIP-3074](https://eips.ethereum.org/EIPS/eip-3074) Invoker is to provide a way to validate and execute call(s) on behalf of an Externally Owned Account (EOA) – 
it is useful for use cases such as batch calls, gas sponsorship, expirations, and more.

A smart contract can become an invoker by inheriting the [`BaseInvoker`](https://github.com/anton-rs/3074-invokers/blob/main/src/BaseInvoker.sol) and implementing the [`exec` function](https://github.com/anton-rs/3074-invokers/blob/05cc5b8532c0b52c9741658f59d1106fd8ced6f2/src/BaseInvoker.sol#L34):

```solidity
// [!code word:BaseInvoker]
contract ExampleInvoker is BaseInvoker {
    /// @param execData   Arbitrary bytes containing invoker-specific 
    ///                   dependencies (such as calls, nonce, expiry, etc)
    ///                   for `exec` to decode.
    /// @param signature  Signature of the auth message that includes 
    ///                   `execData` – computed by the authority account.
    function exec(bytes memory execData, Signature memory signature) internal override { // [!code hl]
        // ...
        authcall(/* ... */)
    }
}
```

:::note
Any smart contract can inherit `BaseInvoker`, whether the goal is to create a [standalone invoker contract](https://github.com/anton-rs/3074-invokers/blob/main/src/BatchInvoker.sol) or [extend a Smart Contract Account (SCA)](https://x.com/WilsonCusack/status/1781424058707345915) to become an invoker.

A popular invoker implementation is the [3074-invokers `BatchInvoker`](https://github.com/anton-rs/3074-invokers/blob/main/src/BatchInvoker.sol) (a standalone invoker), 
which provides an abstraction to execute multiple calls on behalf of an Externally Owned Account (EOA), with replay protection.
:::

This `exec` function internally invokes the EIP-3074 `AUTHCALL` opcode to execute call(s) defined within `execData` on behalf of the Externally Owned Account (EOA) that computed the `signature`. 
The `execData` can also include data other than calls to validate the operation such as: a nonce, expiration, and more. It is up to the `exec` function to validate this data. 

Anyone can invoke the `exec` function provided that the `signature` is correct.

## Import

```ts twoslash
import { getInvoker } from 'viem/experimental'
```

## Usage

:::code-group

```ts twoslash [example.ts] 
// @noErrors
import { getInvoker, batchInvokerCoder, type InvokerArgs } from 'viem/experimental'
import { client } from './config.js'

const invoker = getInvoker({ 
  address: '0x0000000000000000000000000000000000000000', 
  client, 
  coder: batchInvokerCoder(), 
}) 
```

```ts twoslash [example.ts (Full)] 
// @noErrors
import { parseEther } from 'viem'
import { privateKeyToAccount } from 'viem/accounts'
import { getInvoker, batchInvokerCoder, type InvokerArgs } from 'viem/experimental'
import { client } from './config.js'

// 1. Initialize an invoker with it's contract address & `args` coder. // [!code hl]
const invoker = getInvoker({ // [!code hl]
  address: '0x0000000000000000000000000000000000000000', // [!code hl]
  client, // [!code hl]
  coder: batchInvokerCoder(), // [!code hl]
}) // [!code hl]

// 2. Construct calls (`args`) as defined by shape of `batchInvokerCoder`.
const args: InvokerArgs<typeof invoker> = [
  { to: accounts[2].address, value: parseEther('1') },
  { to: accounts[2].address, value: parseEther('2') },
  { to: accounts[2].address, value: parseEther('3') },
]

// 3. Create an authority account to execute the calls on behalf of.
const authority = privateKeyToAccount('0x...')

// 4. Sign the auth message of the calls (`args`) with the authority account.
const signature = await invoker.sign({
  authority,
  args,
})

// 5. Execute the calls (`args`) on behalf of the authority account.
const hash = await invoker.execute({
  authority,
  args,
  signature,
})
```

```ts twoslash [config.ts] filename="config.ts"
import { createWalletClient, http } from 'viem'
import { mainnet } from 'viem/chains'

export const client = createWalletClient({
  chain: mainnet,
  transport: http()
})
```

:::